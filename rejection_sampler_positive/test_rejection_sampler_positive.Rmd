---
title: "Test the rejection sampler"
author: "Yihao Gu"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
source('rejection_sampler_positive.R')
source('helper.R')
library('truncnorm')
```

We first visually compare the empirical distribution with the target density.
```{r}
a = 0.1
c = 10
Nsim = 10^5
res = rejection_sampler_positive(a, c, Nsim)
sample = res$sample
acceptance_rate = res$ar

# Acceptance rate
cat('The acceptance rate is', acceptance_rate, '.\n')

# Plot
plot_lscale_sample(sample, a, c)
```

Now we fix $a$ and see how the acceptance rate changes as $c$ changes.
```{r}
a = 0.1
breakpoint = seq(0, 1/a, length.out=100)
breakpoint = matrix(breakpoint, nrow = 1)
ar = apply(breakpoint, 2, fixed_a_ar(a))
plot(breakpoint, ar, type = 'l', ylim = c(0,1),
     ylab = 'Acceptance Rate', xlab = 'c')
mtext('a = 0.1', side = 3)
```


